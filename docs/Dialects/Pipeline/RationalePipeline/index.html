<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>Pipeline Dialect Rationale - CIRCT</title><meta name=description content="Circuit IR Compilers and Tools"><meta name=generator content="Hugo 0.101.0"><link href=https://circt.llvm.org/index.xml rel=alternate type=application/rss+xml><link rel=canonical href=https://circt.llvm.org/docs/Dialects/Pipeline/RationalePipeline/><link rel=stylesheet href=https://circt.llvm.org/css/theme.css><script src=https://use.fontawesome.com/releases/v5.0.6/js/all.js></script>
<link rel=stylesheet href=https://circt.llvm.org/css/chroma.min.css><script src=https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js></script>
<script src=https://circt.llvm.org/js/bundle.js></script>
<script type=text/javascript src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type=text/x-mathjax-config>
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$', '$'] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    }
  });
</script><style>:root{}</style></head><body><div class=container><header><h1><div><img src=https://circt.llvm.org//circt-logo.svg width=40px align=absmiddle>
CIRCT</div></h1><p class=description>Circuit IR Compilers and Tools</p></header><div class=global-menu><nav><ul><li class=parent><a href>Community<i class="fas fa-angle-right"></i></a><ul class=sub-menu><li class=child><a href=https://llvm.discourse.group/c/Projects-that-want-to-become-official-LLVM-Projects/circt/40>Forums</a></li><li class=child><a href=https://discord.gg/xS7Z362>Chat</a></li></ul></li><li class=parent><a href=https://github.com/llvm/circt/tree/main/>Source<i class="fas fa-angle-right"></i></a><ul class=sub-menu><li class=child><a href=/doxygen/>Doxygen</a></li><li class=child><a href=https://github.com/llvm/circt/tree/main/>GitHub</a></li></ul></li></ul></nav></div><div class=content-container><main><h1>Pipeline Dialect Rationale</h1><p>This document describes various design points of the <code>pipeline</code> dialect, why it is
the way it is, and current status. This follows in the spirit of other
<a href=https://mlir.llvm.org/docs/Rationale/>MLIR
Rationale docs</a>.</p><h2 id=introduction>Introduction&nbsp;<a class=headline-hash href=#introduction>¶</a></h2><h2 id=pipeline-phases>Pipeline Phases&nbsp;<a class=headline-hash href=#pipeline-phases>¶</a></h2><p>A <code>pipeline.pipeline</code> operation can be used in a sequence of phases, each
of which incrementally transforms the pipeline from being unscheduled towards
being an RTL representation of a pipeline. Each phase is mutually exlusive,
meaning that the &ldquo;phase-defining&rdquo; operations
(<code>pipeline.ss, pipeline.ss.reg, pipeline.stage</code>) are not allowed to co-exist.</p><h3 id=phase-1-unscheduled>Phase 1: Unscheduled&nbsp;<a class=headline-hash href=#phase-1-unscheduled>¶</a></h3><p>The highest-level phase that a pipeline may be in is the unscheduled phase.
In this case, the body of the pipeline simply consists of a feed-forward set of
operations representing a dataflow graph.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-mlir data-lang=mlir><span class=line><span class=cl><span class=nv>%out</span> <span class=p>=</span> pipeline<span class=p>.</span>unscheduled<span class=p>(</span><span class=nv>%arg0</span><span class=p>,</span> <span class=nv>%arg1</span><span class=p>,</span> <span class=nv>%go</span><span class=p>)</span> clock <span class=nv>%clk</span> reset <span class=nv>%rst</span> <span class=p>:</span> <span class=p>(</span><span class=k>i32</span><span class=p>,</span> <span class=k>i32</span><span class=p>,</span> <span class=k>i1</span><span class=p>)</span> <span class=p>-&gt;</span> <span class=p>(</span><span class=k>i32</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nl>^bb0</span><span class=p>(</span><span class=nv>%a0</span> <span class=p>:</span> <span class=k>i32</span><span class=p>,</span> <span class=nv>%a1</span><span class=p>:</span> <span class=k>i32</span><span class=p>,</span> <span class=nv>%g</span> <span class=p>:</span> <span class=k>i1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nv>%add0</span> <span class=p>=</span> comb<span class=p>.</span>add <span class=nv>%a0</span><span class=p>,</span> <span class=nv>%a1</span> <span class=p>:</span> <span class=k>i32</span>
</span></span><span class=line><span class=cl>    <span class=nv>%add1</span> <span class=p>=</span> comb<span class=p>.</span>add <span class=nv>%add0</span><span class=p>,</span> <span class=nv>%a0</span> <span class=p>:</span> <span class=k>i32</span>
</span></span><span class=line><span class=cl>    <span class=nv>%add2</span> <span class=p>=</span> comb<span class=p>.</span>add <span class=nv>%add1</span><span class=p>,</span> <span class=nv>%add0</span> <span class=p>:</span> <span class=k>i32</span>
</span></span><span class=line><span class=cl>    pipeline<span class=p>.</span><span class=kt>return</span> <span class=nv>%add2</span> valid <span class=nv>%s1_valid</span> <span class=p>:</span> <span class=k>i32</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=phase-2-scheduled>Phase 2: Scheduled&nbsp;<a class=headline-hash href=#phase-2-scheduled>¶</a></h3><p>Uisng e.g. the <code>pipeline-schedule-linear</code> pass, a pipeline may be scheduled wrt.
an operator library denoting the latency of each operation. The result of a scheduling
problem is the movement of operations to specific blocks.
Each block represents a pipeline stage, with <code>pipeline.stage</code> operations being
stage-terminating operations that determine the order of stages.</p><p>At this level, the semantics of the pipeline are that <strong>any SSA def-use edge that
crosses a stage is a pipeline register</strong>.<br>Note that we also intend to add support for attaching multi-cycle latencies to
SSA values in the future, which will allow for more fine-grained control over
the registers in the pipeline.<br>Given these relaxed semantics, this level of abstraction is suitable for pipeline
retiming. Operations may be moved from one stage to another, or new blocks may be
inserted between existing blocks, without changing the semantics of the pipeline.
The only requirement is that def-use edges wrt. the order of stages are preserved.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-mlir data-lang=mlir><span class=line><span class=cl><span class=nv>%out</span> <span class=p>=</span> pipeline<span class=p>.</span>scheduled<span class=p>(</span><span class=nv>%arg0</span><span class=p>,</span> <span class=nv>%arg1</span><span class=p>,</span> <span class=nv>%go</span><span class=p>)</span> clock <span class=nv>%clk</span> reset <span class=nv>%rst</span> <span class=p>:</span> <span class=p>(</span><span class=k>i32</span><span class=p>,</span> <span class=k>i32</span><span class=p>,</span> <span class=k>i1</span><span class=p>)</span> <span class=p>-&gt;</span> <span class=p>(</span><span class=k>i32</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nl>^bb0</span><span class=p>(</span><span class=nv>%a0</span> <span class=p>:</span> <span class=k>i32</span><span class=p>,</span> <span class=nv>%a1</span><span class=p>:</span> <span class=k>i32</span><span class=p>,</span> <span class=nv>%go</span> <span class=p>:</span> <span class=k>i1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=nv>%add0</span> <span class=p>=</span> comb<span class=p>.</span>add <span class=nv>%a0</span><span class=p>,</span> <span class=nv>%a1</span> <span class=p>:</span> <span class=k>i32</span>
</span></span><span class=line><span class=cl>  pipeline<span class=p>.</span>stage <span class=nl>^bb1 </span>enable <span class=nv>%go</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nl>^bb1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=nv>%add1</span> <span class=p>=</span> comb<span class=p>.</span>add <span class=nv>%add0</span><span class=p>,</span> <span class=nv>%a0</span> <span class=p>:</span> <span class=k>i32</span> <span class=c>// %a0 is a block argument fed through a stage.
</span></span></span><span class=line><span class=cl><span class=c></span>  pipeline<span class=p>.</span>stage <span class=nl>^bb2 </span>enable <span class=nv>%go</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nl>^bb2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=nv>%add2</span> <span class=p>=</span> comb<span class=p>.</span>add <span class=nv>%add1</span><span class=p>,</span> <span class=nv>%add0</span> <span class=p>:</span> <span class=k>i32</span> <span class=c>// %add0 crosses multiple stages.
</span></span></span><span class=line><span class=cl><span class=c></span>  pipeline<span class=p>.</span><span class=kt>return</span> <span class=nv>%add2</span> enable <span class=nv>%go</span> <span class=p>:</span> <span class=k>i32</span> <span class=c>// %go crosses multiple stages
</span></span></span><span class=line><span class=cl><span class=c></span><span class=p>}</span>
</span></span></code></pre></div><h3 id=phase-3-register-materialized>Phase 3: Register materialized&nbsp;<a class=headline-hash href=#phase-3-register-materialized>¶</a></h3><p>Once the prior phase has been completed, pipeline registers must be materialized.<br>This amounts to a dataflow analysis to check the phase 2 property of def-use edges
across pipeline stages, performed by the <code>pipeline-explicit-regs</code> pass.</p><p>The result of this pass is the addition of block arguments to each block representing
a pipeline stage, block arguments which represent stage inputs. It is the
<code>pipeline.stage</code> operation which determines which values are registered and which
are passed through directly. The block arguments to each stage should thus &ldquo;just&rdquo;
be seen as wires feeding into the stage.
In case a value was marked as multicycle, a value is passed through the <code>pass</code> list
in the stage terminating <code>pipeline.stage</code> operation. This indicates that the value
is to be passed through to the target stage without being registered.<br>At this level, an invariant of the pipeline is that <strong>any SSA value used within
a stage must be defined within the stage</strong>, wherein that definition may be either
a block argument or as a result of another operation in the stage.<br>The order of block arguments to a stage is, that register inputs from the
predecessor stage come first, followed by pass-through values. A verifier will
check that the signature of a stage block matches the predecessor <code>pipeline.stage</code>
operation.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-mlir data-lang=mlir><span class=line><span class=cl><span class=nv>%0</span> <span class=p>=</span> pipeline<span class=p>.</span>scheduled<span class=p>(</span><span class=nv>%arg0</span><span class=p>,</span> <span class=nv>%arg1</span><span class=p>,</span> <span class=nv>%go</span><span class=p>)</span> clock <span class=nv>%clk</span> reset <span class=nv>%rst</span> <span class=p>:</span> <span class=p>(</span><span class=k>i32</span><span class=p>,</span> <span class=k>i32</span><span class=p>,</span> <span class=k>i1</span><span class=p>)</span> <span class=p>-&gt;</span> <span class=k>i32</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nl>^bb0</span><span class=p>(</span><span class=nv>%a0</span><span class=p>:</span> <span class=k>i32</span><span class=p>,</span> <span class=nv>%a1</span><span class=p>:</span> <span class=k>i32</span><span class=p>,</span> <span class=nv>%go</span><span class=p>:</span> <span class=k>i1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=nv>%1</span> <span class=p>=</span> comb<span class=p>.</span>add <span class=nv>%a0</span><span class=p>,</span> <span class=nv>%a1</span> <span class=p>:</span> <span class=k>i32</span>
</span></span><span class=line><span class=cl>  pipeline<span class=p>.</span>stage <span class=nl>^bb1 </span>regs <span class=p>(</span><span class=nv>%1</span><span class=p>,</span> <span class=nv>%a0</span><span class=p>,</span> <span class=nv>%go</span><span class=p>)</span> pass <span class=p>()</span> enable <span class=nv>%go</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nl>^bb1</span><span class=p>(</span><span class=nv>%1_s0</span> <span class=p>:</span> <span class=k>i32</span><span class=p>,</span> <span class=nv>%a0_s0</span> <span class=p>:</span> <span class=k>i32</span><span class=p>,</span> <span class=nv>%go_s0</span> <span class=p>:</span> <span class=k>i1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=nv>%2</span> <span class=p>=</span> comb<span class=p>.</span>add <span class=nv>%1_s0</span><span class=p>,</span> <span class=nv>%a0_s0</span> <span class=p>:</span> <span class=k>i32</span>
</span></span><span class=line><span class=cl>  pipeline<span class=p>.</span>stage <span class=nl>^bb2 </span>regs <span class=p>(</span><span class=nv>%2</span><span class=p>,</span> <span class=nv>%1_s0</span><span class=p>,</span> <span class=nv>%go_s0</span><span class=p>)</span> pass <span class=p>()</span> enable <span class=nv>%go_s0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nl>^bb2</span><span class=p>(</span><span class=nv>%2_s1</span> <span class=p>:</span> <span class=k>i32</span><span class=p>,</span> <span class=nv>%1_s1</span> <span class=p>:</span> <span class=k>i32</span><span class=p>,</span> <span class=nv>%go_s1</span> <span class=p>:</span> <span class=k>i1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=nv>%3</span> <span class=p>=</span> comb<span class=p>.</span>add <span class=nv>%2_s1</span><span class=p>,</span> <span class=nv>%1_s1</span> <span class=p>:</span> <span class=k>i32</span> <span class=c>// %1 from the entry stage is chained through both stage 1 and 2.
</span></span></span><span class=line><span class=cl><span class=c></span>  pipeline<span class=p>.</span><span class=kt>return</span> <span class=nv>%3</span> valid <span class=nv>%go_s1</span> <span class=p>:</span> <span class=k>i32</span> <span class=c>// and likewise with %go
</span></span></span><span class=line><span class=cl><span class=c></span><span class=p>}</span>
</span></span></code></pre></div><h2 id=a-note-on-constants>A note on constants&nbsp;<a class=headline-hash href=#a-note-on-constants>¶</a></h2><p>Constants (defined as all operations which the <code>OpTrait::ConstantLike</code> trait) are
special cases in the pipeline dialect. These are allowed to be used anywhere
within the pipeline, and are not subject to the SSA def-use edge restrictions
described above. By doing so, we allow for constant canonicalizers to run,
which may apply regardless of where a constant is used within the pipeline.<br>The result of this is that constant-like operations will be moved to the
entry stage of the pipeline.<br>In the <code>pipeline-to-hw</code> pass, in case the user selects to perform <code>outline</code>d
lowering, constants will be <strong>copied</strong> into the stages which reference them.</p><h2 id=multicycle-operations>Multicycle operations&nbsp;<a class=headline-hash href=#multicycle-operations>¶</a></h2><p>Oftentimes, we may have operations which take multiple cycles to complete within
a pipeline. Support for this is provided by the <code>pipeline.latency</code> operation.
The main purpose of this operation is to provide a way to inform the
register materialization pass to pass values through stages <em>without</em> registering them.</p><p>Currently, all return values have an identical latency. This is an
arbitrary restriction, and may be lifted in the future if needed.</p><p>As an example pipeline:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-mlir data-lang=mlir><span class=line><span class=cl><span class=nl>^bb1</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl><span class=nv>%out</span> <span class=p>=</span> pipeline<span class=p>.</span>latency <span class=m>2</span> <span class=p>-&gt;</span> <span class=p>(</span><span class=k>i32</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nv>%dl1</span> <span class=p>=</span> seq<span class=p>.</span>compreg <span class=nv>%in</span> <span class=p>:</span> <span class=k>i32</span>
</span></span><span class=line><span class=cl>  <span class=nv>%dl2</span> <span class=p>=</span> seq<span class=p>.</span>compreg <span class=nv>%dl1</span> <span class=p>:</span> <span class=k>i32</span>
</span></span><span class=line><span class=cl>  pipeline<span class=p>.</span>latency<span class=p>.</span><span class=kt>return</span> <span class=nv>%dl2</span> <span class=p>:</span> <span class=k>i32</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>pipeline<span class=p>.</span>stage <span class=nl>^bb2
</span></span></span><span class=line><span class=cl><span class=nl>
</span></span></span><span class=line><span class=cl><span class=nl>^bb2</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=c>// It is illegal to reference %out here
</span></span></span><span class=line><span class=cl><span class=c></span>pipeline<span class=p>.</span>stage <span class=nl>^bb3
</span></span></span><span class=line><span class=cl><span class=nl>
</span></span></span><span class=line><span class=cl><span class=nl>
</span></span></span><span class=line><span class=cl><span class=nl>^bb3</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=c>// It is legal to reference %out here
</span></span></span><span class=line><span class=cl><span class=c></span>pipeline<span class=p>.</span>stage <span class=nl>^bb4
</span></span></span><span class=line><span class=cl><span class=nl>
</span></span></span><span class=line><span class=cl><span class=nl>^bb4</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=c>// It is legal to reference %out here. This will also imply a register
</span></span></span><span class=line><span class=cl><span class=c>// between stage bb3 and bb4.
</span></span></span><span class=line><span class=cl><span class=c></span>foo<span class=p>.</span>bar <span class=nv>%out</span> <span class=p>:</span> <span class=k>i32</span>
</span></span></code></pre></div><p>which will register materialize to:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-mlir data-lang=mlir><span class=line><span class=cl><span class=nl>^bb1</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl><span class=nv>%out</span> <span class=p>=</span> pipeline<span class=p>.</span>latency <span class=m>2</span> <span class=p>-&gt;</span> <span class=p>(</span><span class=k>i32</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nv>%dl1</span> <span class=p>=</span> seq<span class=p>.</span>compreg <span class=nv>%in</span> <span class=p>:</span> <span class=k>i32</span>
</span></span><span class=line><span class=cl>  <span class=nv>%dl2</span> <span class=p>=</span> seq<span class=p>.</span>compreg <span class=nv>%dl1</span> <span class=p>:</span> <span class=k>i32</span>
</span></span><span class=line><span class=cl>  pipeline<span class=p>.</span>latency<span class=p>.</span><span class=kt>return</span> <span class=nv>%dl2</span> <span class=p>:</span> <span class=k>i32</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>pipeline<span class=p>.</span>stage <span class=nl>^bb2 </span>pass<span class=p>(</span><span class=nv>%out</span> <span class=p>:</span> <span class=k>i32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nl>^bb2</span><span class=p>(</span><span class=nv>%out_s2</span> <span class=p>:</span> <span class=k>i32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>pipeline<span class=p>.</span>stage <span class=nl>^bb3 </span>pass<span class=p>(</span><span class=nv>%out_s2</span> <span class=p>:</span> <span class=k>i32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nl>^bb3</span><span class=p>(</span><span class=nv>%out_s3</span> <span class=p>:</span> <span class=k>i32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>pipeline<span class=p>.</span>stage <span class=nl>^bb4 </span>regs<span class=p>(</span><span class=nv>%out_s3</span> <span class=p>:</span> <span class=k>i32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nl>^bb4</span><span class=p>(</span><span class=nv>%out_s4</span> <span class=p>:</span> <span class=k>i32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>foo<span class=p>.</span>bar <span class=nv>%out_s4</span> <span class=p>:</span> <span class=k>i32</span>
</span></span></code></pre></div><h2 id=non-stallable-pipeline-stages>Non-stallable Pipeline Stages&nbsp;<a class=headline-hash href=#non-stallable-pipeline-stages>¶</a></h2><p><strong>Note:</strong> the following is only valid for pipelines with a stall signal.</p><p>An option of the Pipeline abstraction presented in this dialect is the ability
to have <em>non-stallable stages</em> (NS). NS stages are used wherever a pipeline
access resources that are not able to stop on a dime, and thus require a fixed
amount of cycles to complete.</p><p>Non-stallable stages are marked as an attribute of the pipeline operations,
wherein a bitvector is provided (by the user) to indicate which stage(s) are
non-stallable.</p><p>To see how non-stallable stages are implemented, consider the following. For
every stage, we define two signals - <code>S_{N,en}</code> is the signal that indicates
that the stage currently has valid contents (i.e. not a bubble). <code>S_{N,valid}</code>
is the signal that is used as a clock-enable for the output registers of a
stage.</p><p>Stages can be grouped into three distinct types based on how their valid signal
is defined: stallable stages, non-stallable stages and runoff stages.</p><img title="Stage control" src=includes/img/Pipeline/stage_control.png><ol><li>Stallable stages are any stages which appear <strong>before</strong> the first
non-stallable stage in the pipeline.</li><li>Non-stallable stages are the stages explicitly marked as non-stallable by the
user.</li><li>Runoff stages and stages that appear <strong>after</strong> (and by extension, <strong>between</strong>
non-stallable stages). Runoff stages consider their own enablement wrt. the
stall signal, as well as the enablement of the <strong>last non-stallable
register</strong> (LNS) wrt. the runoff stage&rsquo;s position in the pipeline.</li></ol><p>The purpose of the runoff stages is to ensure that they are able to pass through
as many pipeline cycles as there are upstream non-stallable stages, such that
the contents of the non-stallable stages is not discarded.<br>An important implication of this is that pipelines with non-stallable stages
<strong>must</strong> be connected to some buffer mechanism that is able to hold as many
pipeline output value cycles as there are non-stallable stages in the pipeline.</p><p>As an example, the following 6 stage pipeline will have the following valid
signals: <img title="Stage control" src=includes/img/Pipeline/ns_ex1.png></p><h3 id=example-1>Example 1:&nbsp;<a class=headline-hash href=#example-1>¶</a></h3><p>In this example, we have two NS stages followed by three runoff stages:</p><img title="Stage control" src=includes/img/Pipeline/ns_ex2.png><p>In this example we see that, as expected, two cycles are output from the
pipeline after the stall signal goes high, corresponding to the two NS stages.</p><h3 id=example-2>Example 2:&nbsp;<a class=headline-hash href=#example-2>¶</a></h3><p>In this example, we have two NS stages, then one runoff stage, then one NS
stage, and finally one runoff stage:</p><img title="Stage control" src=includes/img/Pipeline/ns_ex3.png><p>In this example we see that, as expected, three cycles are output from the
pipeline after the stall signal goes high, corresponding to the three NS stages.</p><div class=edit-meta><br></div><nav class=pagination><a class="nav nav-prev" href=https://circt.llvm.org/docs/Dialects/Pipeline/ title="'pipeline' Dialect"><i class="fas fa-arrow-left" aria-hidden=true></i> Prev - 'pipeline' Dialect</a>
<a class="nav nav-next" href=https://circt.llvm.org/docs/Dialects/Seq/ title="'seq' Dialect">Next - 'seq' Dialect <i class="fas fa-arrow-right" aria-hidden=true></i></a></nav><footer><p class=powered>Powered by <a href=https://gohugo.io>Hugo</a>. Theme by <a href=https://themes.gohugo.io/hugo-theme-techdoc/>TechDoc</a>. Designed by <a href=https://github.com/thingsym/hugo-theme-techdoc>Thingsym</a>.</p></footer></main><div class=sidebar><nav class=slide-menu><ul><li><a href=https://circt.llvm.org/>Home</a></li><li><a href=https://circt.llvm.org/talks/>Talks and Related Publications</a></li><li><a href=https://circt.llvm.org/getting_started/>Getting Started</a></li><li class="parent has-sub-menu"><a href=https://circt.llvm.org/docs/>Code Documentation<span class="mark opened">-</span></a><ul class=sub-menu><li class=has-sub-menu><a href=https://circt.llvm.org/docs/CommandGuide/>CommandGuide<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://circt.llvm.org/docs/CommandGuide/handshake-runner/>handshake-runner</a></li></ul></li><li><a href=https://circt.llvm.org/docs/Charter/>CIRCT Charter</a></li><li class="parent has-sub-menu"><a href=https://circt.llvm.org/docs/Dialects/>Dialects<span class="mark opened">-</span></a><ul class=sub-menu><li><a href=https://circt.llvm.org/docs/Dialects/ESIAppID/></a></li><li><a href=https://circt.llvm.org/docs/Dialects/Arc/>'arc' Dialect</a></li><li><a href=https://circt.llvm.org/docs/Dialects/Calyx/>'calyx' Dialect</a></li><li><a href=https://circt.llvm.org/docs/Dialects/CHIRRTL/>'chirrtl' Dialect</a></li><li class=has-sub-menu><a href=https://circt.llvm.org/docs/Dialects/Comb/>'comb' Dialect<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://circt.llvm.org/docs/Dialects/Comb/RationaleComb/>`comb` Dialect Rationale</a></li></ul></li><li class=has-sub-menu><a href=https://circt.llvm.org/docs/Dialects/DC/>'dc' Dialect<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://circt.llvm.org/docs/Dialects/DC/RationaleDC/>DC Dialect Rationale</a></li></ul></li><li class=has-sub-menu><a href=https://circt.llvm.org/docs/Dialects/Emit/>'emit' Dialect<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://circt.llvm.org/docs/Dialects/Emit/RationaleEmit/>Emission (Emit) Dialect Rationale</a></li></ul></li><li class=has-sub-menu><a href=https://circt.llvm.org/docs/Dialects/ESI/>'esi' Dialect<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://circt.llvm.org/docs/Dialects/ESI/cosim/>ESI cosimulation model</a></li><li><a href=https://circt.llvm.org/docs/Dialects/ESI/types/>ESI data types and communication types</a></li><li><a href=https://circt.llvm.org/docs/Dialects/ESI/services/>ESI Global Services</a></li><li><a href=https://circt.llvm.org/docs/Dialects/ESI/software_api/>ESI Software APIs</a></li><li><a href=https://circt.llvm.org/docs/Dialects/ESI/notes/>Miscellaneous Notes</a></li><li><a href=https://circt.llvm.org/docs/Dialects/ESI/RationaleESI/>The Elastic Silicon Interconnect dialect</a></li></ul></li><li class=has-sub-menu><a href=https://circt.llvm.org/docs/Dialects/FIRRTL/>'firrtl' Dialect<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://circt.llvm.org/docs/Dialects/FIRRTL/FIRRTLAnnotations/>FIRRTL Annotations</a></li><li><a href=https://circt.llvm.org/docs/Dialects/FIRRTL/RationaleFIRRTL/>FIRRTL Dialect Rationale</a></li><li><a href=https://circt.llvm.org/docs/Dialects/FIRRTL/FIRRTLIntrinsics/>Intrinsics</a></li></ul></li><li class=has-sub-menu><a href=https://circt.llvm.org/docs/Dialects/FSM/>'fsm' Dialect<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://circt.llvm.org/docs/Dialects/FSM/RationaleFSM/>FSM Dialect Rationale</a></li></ul></li><li class=has-sub-menu><a href=https://circt.llvm.org/docs/Dialects/Handshake/>'handshake' Dialect<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://circt.llvm.org/docs/Dialects/Handshake/RationaleHandshake/>Handshake Dialect Rationale</a></li></ul></li><li class=has-sub-menu><a href=https://circt.llvm.org/docs/Dialects/HW/>'hw' Dialect<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://circt.llvm.org/docs/Dialects/HW/RationaleHW/>HW Dialect Rationale</a></li></ul></li><li class=has-sub-menu><a href=https://circt.llvm.org/docs/Dialects/HWArith/>'hwarith' Dialect<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://circt.llvm.org/docs/Dialects/HWArith/RationaleHWArith/>HW Arith Dialect Rationale</a></li></ul></li><li class=has-sub-menu><a href=https://circt.llvm.org/docs/Dialects/Ibis/>'ibis' Dialect<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://circt.llvm.org/docs/Dialects/Ibis/RationaleIbis/>`ibis` Dialect Rationale</a></li></ul></li><li><a href=https://circt.llvm.org/docs/Dialects/LLHD/>'llhd' Dialect</a></li><li class=has-sub-menu><a href=https://circt.llvm.org/docs/Dialects/LoopSchedule/>'loopschedule' Dialect<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://circt.llvm.org/docs/Dialects/LoopSchedule/LoopSchedule/>LoopSchedule Dialect Rationale</a></li></ul></li><li><a href=https://circt.llvm.org/docs/Dialects/LTL/>'ltl' Dialect</a></li><li><a href=https://circt.llvm.org/docs/Dialects/Moore/>'moore' Dialect</a></li><li><a href=https://circt.llvm.org/docs/Dialects/MSFT/>'msft' Dialect</a></li><li class=has-sub-menu><a href=https://circt.llvm.org/docs/Dialects/OM/>'om' Dialect<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://circt.llvm.org/docs/Dialects/OM/RationaleOM/>Object Model Dialect Rationale</a></li></ul></li><li class="parent has-sub-menu"><a href=https://circt.llvm.org/docs/Dialects/Pipeline/>'pipeline' Dialect<span class="mark opened">-</span></a><ul class=sub-menu><li class=active><a href=https://circt.llvm.org/docs/Dialects/Pipeline/RationalePipeline/>Pipeline Dialect Rationale</a></li></ul></li><li class=has-sub-menu><a href=https://circt.llvm.org/docs/Dialects/Seq/>'seq' Dialect<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://circt.llvm.org/docs/Dialects/Seq/RationaleSeq/>Seq(uential) Dialect Rationale</a></li></ul></li><li><a href=https://circt.llvm.org/docs/Dialects/Sim/>'sim' Dialect</a></li><li class=has-sub-menu><a href=https://circt.llvm.org/docs/Dialects/Sim/>'sim' Dialect<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://circt.llvm.org/docs/Dialects/Sim/RationaleSim/>Simulation (Sim) Dialect Rationale</a></li></ul></li><li class=has-sub-menu><a href=https://circt.llvm.org/docs/Dialects/SSP/>'ssp' Dialect<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://circt.llvm.org/docs/Dialects/SSP/RationaleSSP/>SSP Dialect Rationale</a></li></ul></li><li class=has-sub-menu><a href=https://circt.llvm.org/docs/Dialects/SV/>'sv' Dialect<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://circt.llvm.org/docs/Dialects/SV/RationaleSV/>SV Dialect Rationale</a></li></ul></li><li class=has-sub-menu><a href=https://circt.llvm.org/docs/Dialects/SystemC/>'systemc' Dialect<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://circt.llvm.org/docs/Dialects/SystemC/RationaleSystemC/>SystemC Dialect Rationale</a></li></ul></li><li><a href=https://circt.llvm.org/docs/Dialects/Verif/>'verif' Dialect</a></li><li><a href=https://circt.llvm.org/docs/Dialects/Debug/>Debug Dialect</a></li><li class=has-sub-menu><a href=https://circt.llvm.org/docs/Dialects/Interop/>Interop Dialect<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://circt.llvm.org/docs/Dialects/Interop/RationaleInterop/>Interoperability Dialect Rationale</a></li></ul></li><li><a href=https://circt.llvm.org/docs/Dialects/SMT/>SMT Dialect</a></li></ul></li><li><a href=https://circt.llvm.org/docs/ToolsWorkarounds/>EDA Tool Workarounds</a></li><li><a href=https://circt.llvm.org/docs/FormalVerification/>Formal Verification Tooling</a></li><li><a href=https://circt.llvm.org/docs/GettingStarted/>Getting Started with the CIRCT Project</a></li><li><a href=https://circt.llvm.org/docs/HLS/>HLS in CIRCT</a></li><li><a href=https://circt.llvm.org/docs/Passes/>Passes</a></li><li class=has-sub-menu><a href=https://circt.llvm.org/docs/PyCDE/>Python CIRCT Design Entry (PyCDE)<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=https://circt.llvm.org/docs/PyCDE/compiling/>Compiling CIRCT and PyCDE</a></li><li><a href=https://circt.llvm.org/docs/PyCDE/basics/>PyCDE Basics</a></li></ul></li><li><a href=https://circt.llvm.org/docs/Scheduling/>Static scheduling infrastructure</a></li><li><a href=https://circt.llvm.org/docs/RationaleSymbols/>Symbol and Inner Symbol Rationale</a></li><li><a href=https://circt.llvm.org/docs/PythonBindings/>Using the Python Bindings</a></li><li><a href=https://circt.llvm.org/docs/VerilogGeneration/>Verilog and SystemVerilog Generation</a></li></ul></li></ul></nav><div class=sidebar-footer></div></div></div><a href=# id=backtothetop-fixed class=backtothetop data-backtothetop-duration=600 data-backtothetop-easing=easeOutQuart data-backtothetop-fixed-fadein=1000 data-backtothetop-fixed-fadeout=1000 data-backtothetop-fixed-bottom=10 data-backtothetop-fixed-right=20><span class="fa-layers fa-fw"><i class="fas fa-circle"></i>
<i class="fas fa-arrow-circle-up"></i></span></a></div></body></html>